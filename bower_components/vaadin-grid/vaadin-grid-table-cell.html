<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="vaadin-grid-cell-click-behavior.html"></head><body><dom-module id="vaadin-grid-table-cell"></dom-module><dom-module id="vaadin-grid-table-header-cell"></dom-module><dom-module id="vaadin-grid-table-footer-cell"></dom-module><dom-module id="vaadin-grid-sizer-cell"></dom-module><script>(function(){var c={properties:{column:Object,expanded:Boolean,flexGrow:Number,focused:{type:Boolean,reflectToAttribute:!0},frozen:{type:Boolean,reflectToAttribute:!0},lastFrozen:{type:Boolean,reflectToAttribute:!0},hidden:{type:Boolean,reflectToAttribute:!0},instance:Object,index:Number,item:Object,selected:Boolean,template:Object,target:Object,width:String,order:Number,reorderStatus:{type:String,reflectToAttribute:!0},_childColumns:Array,_cellContent:Object,_insertionPoint:Object,_templatizer:Object},observers:['_columnChanged(column)','_cellAttached(column, isAttached)','_expandedChanged(expanded, instance)','_flexGrowChanged(flexGrow)','_indexChanged(index, instance)','_itemChanged(item, instance)','_instanceChanged(instance, target)','_selectedChanged(selected, instance)','_toggleContent(isAttached, _cellContent, _insertionPoint)','_toggleInstance(isAttached, _templatizer, instance)','_widthChanged(width)','_orderChanged(order)','_visibleChildColumnsChanged(_visibleChildColumns)','_childColumnsChanged(_childColumns)'],created:function(){this.classList.add('vaadin-grid-cell')},_columnChanged:function(f){this.flexGrow=f.flexGrow,this.frozen=f.frozen,this.lastFrozen=f._lastFrozen,this.headerTemplate=f.headerTemplate,this.footerTemplate=f.footerTemplate,this.template=f.template,this.width=f.width,this.hidden=f.hidden,this.resizable=f.resizable,this._childColumns=f._childColumns,this.order=f._order,f.colSpan&&this.setAttribute('colspan',f.colSpan),this.listen(f,'property-changed','_columnPropChanged')},_cellAttached:function(f,g){g?this.listen(f,'property-changed','_columnPropChanged'):this.unlisten(f,'property-changed','_columnPropChanged')},_columnPropChanged:function(f){f.target==this.column&&('colSpan'===f.detail.path?this.setAttribute('colspan',f.detail.value):this[f.detail.path]=f.detail.value)},_expandedChanged:function(f,g){g.__expanded__=f,g.expanded=f},_flexGrowChanged:function(f){this.style.flexGrow=f},_indexChanged:function(f,g){g.index=f},_itemChanged:function(f,g){g.item=f},_selectedChanged:function(f,g){g.__selected__=f,g.selected=f},_childColumnsChanged:function(f){this.setAttribute('colspan',f.length)},_toggleContent:function(f,g,h){f?(Polymer.dom(g).parentNode!==this.target&&Polymer.dom(this.target).appendChild(g),Polymer.dom(this).appendChild(h)):this.async(function(){this.isAttached||Polymer.dom(g).parentNode!==this.target||Polymer.dom(this.target).removeChild(g)})},_toggleInstance:function(f,g,h){f?g.addInstance(h):g.removeInstance(h)},_widthChanged:function(f){this.style.width=f},_orderChanged:function(f){this.style.order=f},_templateChanged:function(f){this.instance=f.templatizer.createInstance(),this._templatizer=f.templatizer},_instanceChanged:function(){this.style.height='',this._cellContent=document.createElement('vaadin-grid-cell-content');var h=vaadin.elements.grid._contentIndex=vaadin.elements.grid._contentIndex+1||0,i='vaadin-grid-cell-content-'+h;this._cellContent.setAttribute('id',i),Polymer.dom(this._cellContent).appendChild(this.instance.root),this._insertionPoint=document.createElement('content'),this._insertionPoint.setAttribute('select','#'+i)}};Polymer({is:'vaadin-grid-table-cell',extends:'td',behaviors:[c,vaadin.elements.grid.CellClickBehavior],observers:['_templateChanged(template)'],_cellClick:function(f){f.defaultPrevented||this.fire('cell-activate',{model:this.instance})}}),Polymer({is:'vaadin-grid-table-header-cell',extends:'th',properties:{headerTemplate:Object,resizable:Boolean,columnResizing:{type:Boolean,reflectToAttribute:!0}},behaviors:[c,vaadin.elements.grid.CellClickBehavior],observers:['_headerTemplateChanged(headerTemplate, isAttached)','_resizableChanged(resizable)'],listeners:{mousedown:'_cancelMouseDownOnResize',mousemove:'_enableDrag',mouseout:'_disableDrag',touchstart:'_onTouchStart',touchmove:'_onTouchMove',touchend:'_onTouchEnd',contextmenu:'_onContextMenu'},_onContextMenu:function(f){this._reorderGhost&&f.preventDefault()},_onTouchStart:function(f){f.target!==this._resizeHandle&&this.target.columnReorderingAllowed&&(this._startReorderTimeout=setTimeout(this._startReorder.bind(this,f),100))},_startReorder:function(f){this._reorderGhost=this._getGhost(),this._reorderGhost.style.visibility='visible';var g=new CustomEvent('dragstart',{bubbles:!0});this._cellContent.dispatchEvent(g),this._reorderXY={x:f.touches[0].clientX-this.getBoundingClientRect().left,y:f.touches[0].clientY-this.getBoundingClientRect().top},this._updateGhostPosition(f.touches[0].clientX,f.touches[0].clientY)},_onTouchMove:function(f){if(this._reorderGhost){f.preventDefault();var g=new CustomEvent('dragover',{bubbles:!0});g.clientX=f.touches[0].clientX,g.clientY=f.touches[0].clientY;var h=this._contentFromPoint(g.clientX,g.clientY);h&&h.dispatchEvent(g),this._updateGhostPosition(f.touches[0].clientX,f.touches[0].clientY)}else clearTimeout(this._startReorderTimeout)},_updateGhostPosition:function(f,g){var h=f-this._reorderXY.x,i=g-this._reorderXY.y-50,j=parseInt(this._reorderGhost.style.left||0),k=parseInt(this._reorderGhost.style.top||0),l=this._reorderGhost.getBoundingClientRect();this._reorderGhost.style.left=j-(l.left-h)+'px',this._reorderGhost.style.top=k-(l.top-i)+'px'},_onTouchEnd:function(f){if(clearTimeout(this._startReorderTimeout),this._reorderGhost){f.preventDefault();var g=new CustomEvent('dragend',{bubbles:!0});this.dispatchEvent(g),this._reorderGhost.style.visibility='hidden',this._reorderGhost=null}},_contentFromPoint:function(f,g){if(Polymer.Settings.useShadow){var h=this.target.$.scroller;h.toggleAttribute('no-content-pointer-events',!0);var i=h.root.elementFromPoint(f,g);if(h.toggleAttribute('no-content-pointer-events',!1),i&&i.getContentChildren)return i.getContentChildren('content')[0]}else return document.elementFromPoint(f,g)},_getGhost:function(){var f=this.target.$.scroller.$.reorderghost;f.innerText=this._cellContent.innerText;var g=window.getComputedStyle(this._cellContent);return['boxSizing','display','width','height','background','alignItems','padding','border','flex-direction','overflow'].forEach(function(h){f.style[h]=g[h]},this),f},_enableDrag:function(){this._cellContent.draggable=this.target.columnReorderingAllowed&&!window.getSelection().toString()},_disableDrag:function(){this._cellContent.draggable=!1},_cancelMouseDownOnResize:function(f){f.target===this._resizeHandle&&f.preventDefault()},_resizableChanged:function(f){f?(this._resizeHandle=document.createElement('div'),this._resizeHandle.classList.add('vaadin-grid-column-resize-handle'),this.listen(this._resizeHandle,'track','_onTrack'),Polymer.dom(this).appendChild(this._resizeHandle)):this._resizeHandle&&(this.unlisten(this._resizeHandle,'track','_onTrack'),Polymer.dom(this).removeChild(this._resizeHandle))},_onTrack:function(f){this.columnResizing=!0;var g=this.column;'vaadin-grid-column-group'===g.localName&&(g=g._childColumns.slice(0).sort(function(l,m){return l._order-m._order}).filter(function(l){return!l.hidden}).pop());var h=this._getHeaderCellByColumn(g);if(h.offsetWidth){var i=window.getComputedStyle(h._cellContent),j=10+parseInt(i.paddingLeft)+parseInt(i.paddingRight);g.width=Math.max(j,h.offsetWidth+f.detail.x-h.getBoundingClientRect().right)+'px',g.flexGrow=0}var k=this.parentElement.parentElement;Polymer.dom(k).querySelectorAll('tr:last-child th').sort(function(l,m){return l.column._order-m.column._order}).forEach(function(l,m,n){m<n.indexOf(h)&&(l.column.width=l.offsetWidth+'px',l.column.flexGrow=0)}),this.columnResizing&&'end'===f.detail.state&&(this.columnResizing=!1),this.fire('column-resizing')},_getHeaderCellByColumn:function(f){var g=this.parentElement.parentElement;return Polymer.dom(g).querySelectorAll('tr:last-child th').filter(function(h){return h.column===f})[0]},_headerTemplateChanged:function(f,g){null!==f&&(this._isColumnRow||'vaadin-grid-column-group'===this.column.localName)?(this._isEmpty=!1,this.instance=this.instance||f.templatizer.createInstance(),this._templatizer=f.templatizer):(this._isEmpty=!0,this.instance=this.instance||{root:document.createElement('div')}),g&&this.fire('cell-empty-changed')}}),Polymer({is:'vaadin-grid-table-footer-cell',extends:'td',properties:{footerTemplate:Object},behaviors:[c,vaadin.elements.grid.CellClickBehavior],observers:['_footerTemplateChanged(footerTemplate, isAttached)'],_footerTemplateChanged:function(f,g){null!==f&&(this._isColumnRow||'vaadin-grid-column-group'===this.column.localName)?(this._isEmpty=!1,this.instance=this.instance||f.templatizer.createInstance(),this._templatizer=f.templatizer):(this._isEmpty=!0,this.instance=this.instance||{root:document.createElement('div')}),g&&this.fire('cell-empty-changed')}}),Polymer({is:'vaadin-grid-sizer-cell',behaviors:[c]})})();</script></body></html>