<html><head><link rel="import" href="../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html"><link rel="import" href="../iron-a11y-announcer/iron-a11y-announcer.html"></head><body><dom-module id="vaadin-grid-navigation-themability-styles"><template><style>:host(:focus){outline:none;}:host([navigating]:not([interacting])) [focused] > tr[focused] > [focused] ::content > vaadin-grid-cell-content{box-shadow:inset 0 0 0 3px rgba(0, 0, 0, 0.3);@apply (--vaadin-grid-focused-cell);}</style></template></dom-module><script>window.vaadin=window.vaadin||{},vaadin.elements=vaadin.elements||{},vaadin.elements.grid=vaadin.elements.grid||{},vaadin.elements.grid.KeyboardNavigationBehaviorImpl={hostAttributes:{tabindex:-1,role:'application'},keyBindings:{'ctrl+home':'_onCtrlHome','ctrl+end':'_onCtrlEnd',down:'_onArrowDown',end:'_onEnd',enter:'_onEnter',esc:'_onEscape',f2:'_onF2',home:'_onHome',left:'_onArrowLeft',pagedown:'_onPageDown',pageup:'_onPageUp',right:'_onArrowRight','shift+tab':'_onShiftTab',space:'_onSpace',tab:'_onTab',up:'_onArrowUp'},attached:function(){Polymer.IronA11yAnnouncer.requestAvailability()},_onEnd:function(b){this.$.scroller._onEnd(b)},_onEnter:function(b){this.$.scroller._onEnter(b)},_onEscape:function(b){this.$.scroller._onEscape(b)},_onF2:function(b){this.$.scroller._onF2(b)},_onTab:function(b){this.$.scroller._onTab(b)},_onShiftTab:function(b){this.$.scroller._onShiftTab(b)},_onArrowDown:function(b){this.$.scroller._onArrowDown(b)},_onArrowUp:function(b){this.$.scroller._onArrowUp(b)},_onArrowRight:function(b){this.$.scroller._onArrowRight(b)},_onArrowLeft:function(b){this.$.scroller._onArrowLeft(b)},_onHome:function(b){this.$.scroller._onHome(b)},_onCtrlHome:function(b){this.$.scroller._onCtrlHome(b)},_onCtrlEnd:function(b){this.$.scroller._onCtrlEnd(b)},_onPageDown:function(b){this.$.scroller._onPageDown(b)},_onPageUp:function(b){this.$.scroller._onPageUp(b)},_onSpace:function(b){this.$.scroller._onSpace(b)}},vaadin.elements.grid.KeyboardNavigationBehavior=[vaadin.elements.grid.KeyboardNavigationBehaviorImpl,Polymer.IronA11yKeysBehavior],vaadin.elements.grid.TableKeyboardBehavior={properties:{_virtualFocus:{type:Object,observer:'_virtualFocusChanged'},interacting:{type:Boolean,reflectToAttribute:!0,value:!1},navigating:{type:Boolean,reflectToAttribute:!0,value:!1}},listeners:{'cell-focus':'_onCellFocus','cell-content-focus':'_onCellContentFocus'},_isFooterVisible:function(){return 0<this.$.footer._rows.filter(function(b){return!b.hidden}).length},_onFocusout:function(){this.navigating=!1,this.interacting=!1},_onHeaderFocus:function(){this.navigating=!0,this.interacting=!1,this.$.header._focusedCellIndex=this.$.header._focusedCellIndex||0,this.$.header._focusedRowIndex=this.$.header._focusedRowIndex||0,this._virtualFocus=this.$.header},_onBodyFocus:function(){this.navigating=!0,this.interacting=!1,this.$.items._focusedCellIndex=this.$.items._focusedCellIndex||0,this.$.items._focusedRowIndex=this.$.items._focusedRowIndex||0,this._virtualFocus=this.$.items},_onFooterFocus:function(){this._isFooterVisible()?(this.navigating=!0,this.interacting=!1,this.$.footer._focusedCellIndex=this.$.footer._focusedCellIndex||0,this.$.footer._focusedRowIndex=this.$.footer._focusedRowIndex||0,this._virtualFocus=this.$.footer):!this._virtualFocus&&this.$.bodyFocusTrap.focus()},_virtualFocusChanged:function(b,c){c&&(c.focused=!1),b&&(b.focused=!0,b===this.$.items&&this._ensureVirtualFocusInViewport())},_onTab:function(b){if(!this.interacting&&this._virtualFocus)if(this.navigating)switch(this._virtualFocus){case this.$.header:this.$.bodyFocusTrap.focus(),b.preventDefault();break;case this.$.items:this.$.footerFocusTrap.focus(),this._isFooterVisible()?(this._virtualFocus=this.$.footer,b.preventDefault()):this.async(function(){this._virtualFocus=null},1);break;case this.$.footer:this._virtualFocus=null;}else{switch(this._virtualFocus){case this.$.header:this.$.headerFocusTrap.focus();break;case this.$.items:this.$.bodyFocusTrap.focus();break;case this.$.footer:this.$.footerFocusTrap.focus();}b.preventDefault()}},_onShiftTab:function(b){if(!this.interacting)if(this.navigating)switch(this._virtualFocus){case this.$.footer:this.$.bodyFocusTrap.focus(),b.preventDefault();break;case this.$.items:this.$.headerFocusTrap.focus(),b.preventDefault();break;case this.$.header:this._virtualFocus=null;}else{switch(this._virtualFocus){case this.$.footer:this.$.footerFocusTrap.focus();break;case this.$.items:this.$.bodyFocusTrap.focus();break;case this.$.header:this.$.headerFocusTrap.focus();}b.preventDefault()}},_isAboveViewport:function(b){return this.firstVisibleIndex>b},_onArrowDown:function(b){this.interacting||(b.preventDefault(),this.navigating=!0,this._virtualFocus.focusDown(),this._ensureVirtualFocusInViewport())},_scrollPageDown:function(){var b=this.$.header.getBoundingClientRect(),c=this.$.footer.getBoundingClientRect();this.$.table.scrollTop+=c.top-b.bottom,this._scrollHandler()},_onPageDown:function(b){if(!this.interacting)if(b.preventDefault(),this.navigating=!0,this._virtualFocus===this.$.items){var c=this.lastVisibleIndex;this._scrollPageDown(),this._virtualFocus._focusedRowIndex+=this.lastVisibleIndex-c||this.lastVisibleIndex-this._virtualFocus._focusedRowIndex,this._ensureVirtualFocusInViewport()}else this._virtualFocus.focusPageDown()},_scrollPageUp:function(){var b=this.$.header.getBoundingClientRect(),c=this.$.footer.getBoundingClientRect();this.$.table.scrollTop-=c.top-b.bottom,this._scrollHandler()},_onPageUp:function(b){if(!this.interacting)if(b.preventDefault(),this.navigating=!0,this._virtualFocus===this.$.items){var c=this.lastVisibleIndex;this._scrollPageUp(),this._virtualFocus._focusedRowIndex-=c-this.lastVisibleIndex||this._virtualFocus._focusedRowIndex,this._ensureVirtualFocusInViewport()}else this._virtualFocus.focusPageUp()},_onArrowUp:function(b){this.interacting||(b.preventDefault(),this.navigating=!0,this._virtualFocus.focusUp(),this._ensureVirtualFocusInViewport())},_onArrowRight:function(b){this.interacting||(b.preventDefault(),this.navigating=!0,this._virtualFocus.focusRight(),this._ensureVirtualFocusInViewport())},_onArrowLeft:function(b){this.interacting||(b.preventDefault(),this.navigating=!0,this._virtualFocus.focusLeft(),this._ensureVirtualFocusInViewport())},_onHome:function(b){this.interacting||(b.preventDefault(),this.navigating=!0,this._virtualFocus.focusHome(),this._ensureVirtualFocusInViewport())},_onEnd:function(b){this.interacting||(b.preventDefault(),this.navigating=!0,this._virtualFocus.focusEnd(),this._ensureVirtualFocusInViewport())},_moveFocusToFocusTarget:function(){var b=this._virtualFocus._focusedCell._cellContent,c=b.querySelector('[focus-target]')||b.firstElementChild;c&&c.focus()},_onEnter:function(b){this.interacting?'input'===b.detail.keyboardEvent.target.localName&&'text'===b.detail.keyboardEvent.target.type&&(this.interacting=!1,this._onTab(b)):(b.preventDefault(),this._moveFocusToFocusTarget())},_onEscape:function(b){this.interacting?(this.interacting=!1,this._onTab(b)):this.navigating&&this.domHost.focus()},_onF2:function(b){b.preventDefault(),this.interacting?(this.interacting=!1,this._onTab(b)):this._moveFocusToFocusTarget()},_onCtrlHome:function(b){this.interacting||(b.preventDefault(),this.navigating=!0,this._virtualFocus.focusFirst(),this._ensureVirtualFocusInViewport())},_onCtrlEnd:function(b){this.interacting||(b.preventDefault(),this.navigating=!0,this._virtualFocus.focusLast(),this._ensureVirtualFocusInViewport())},_onSpace:function(b){if(!this.interacting){b.preventDefault();var c=this._virtualFocus._focusedCell,d=c.getContentChildren('content')[0].firstElementChild;d?d.click():this.navigating&&this.fire('cell-activate',{model:c.instance})}},_onCellContentFocus:function(b){this.interacting=!0,this._onCellFocus(b)},_onCellFocus:function(b){var c=b.detail.cell,d=c.parentElement,f=d.parentElement,g=Polymer.dom(f).children.indexOf(d);f===this.$.items&&(g=d.index),f._focusedRowIndex=g,f._focusedCellIndex=Polymer.dom(d).children.indexOf(c),this._virtualFocus=f,c.hasAttribute('detailscell')&&(f._focusedCellIndex=0,f._moveFocusToDetailsCell())},_ensureVirtualFocusInViewport:function(){var b=this._vidxOffset+this._virtualStart,c=this._virtualFocus._focusedRowIndex;this._virtualFocus===this.$.items&&(c<b||c>b+this._physicalCount)?(this.scrollToScaledIndex(c),this._virtualFocus._focusedCellChanged(c,this._virtualFocus._focusedCellIndex)):this._ensureElementInViewport(this._virtualFocus._focusedCell)},_ensureElementInViewport:function(b){var c=b.getBoundingClientRect();if(this._virtualFocus===this.$.items){var d=this.$.footer.getBoundingClientRect().top,f=this.$.header.getBoundingClientRect().bottom;c.bottom>d?this.$.table.scrollTop+=c.bottom-d:c.top<f&&(this.$.table.scrollTop+=c.top-f)}if(!b.hasAttribute('detailscell')){var g=this.$.table.getBoundingClientRect().right,h=this.$.table.getBoundingClientRect().left,i=this._virtualFocus._focusedRow.querySelector('[last-frozen]');i&&(h=i.getBoundingClientRect().right),c.right>g?this.$.table.scrollLeft+=c.right-g:c.left<h&&(this.$.table.scrollLeft+=c.left-h)}}};</script></body></html>