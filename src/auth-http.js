window.PatientPortal=window.PatientPortal||{},window.PatientPortal.http=function(){function a(){var d=new Headers,e=localStorage.getItem('authToken');return e&&d.append('Authorization','Bearer '+e),d.append('content-type','application/json'),d}function b(d,e,f){return new Request(PatientPortal.config.apiUrl+'/'+e,{method:d,headers:a(),body:JSON.stringify(f)})}function c(d){if(d.ok)return d;if(401===d.status||403===d.status)return localStorage.removeItem('authToken'),void document.dispatchEvent(new CustomEvent('log-out',{bubbles:!0}));throw new Error('Things went horribly wrong',d)}return{get:function(e){return fetch(b('GET',e)).then(c).then(function(f){return f.json()})},post:function(e,f){return fetch(b('POST',e,f)).then(c).then(function(g){return g.json()})},put:function(e,f){return fetch(b('PUT',e,f)).then(c)},delete:function(e){return fetch(b('DELETE',e)).then(c).then(function(f){return f.json()})},login:function(e){return new Promise(function(f,g){fetch(PatientPortal.config.apiUrl+'/login',{method:'POST',body:JSON.stringify(e)}).then(function(h){if(h.headers.has('Authorization')){var i=h.headers.get('Authorization').substring(7);localStorage.setItem('authToken',i),f(i)}else g('Well that didn\'t work.')}).catch(function(h){return g(h)})})},logout:function(){localStorage.removeItem('authToken')}}}();